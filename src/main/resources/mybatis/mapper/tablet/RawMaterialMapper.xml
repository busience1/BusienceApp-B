<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.busience.tablet.dao.RawMaterialDao">

	<select id="rawMaterialSelectDao" resultType="com.busience.tablet.dto.RawMaterialDto">
		select distinct
			A.Material_ItemCode,
		    B.Product_Item_Name Material_ItemName,
		    (SELECT Material_LotNo FROM Raw_Material_tbl where Material_ItemCode = A.Material_ItemCode order by CrateDate desc limit 1) Material_LotNo,
		    (SELECT Qty FROM Raw_Material_tbl where Material_ItemCode = A.Material_ItemCode order by CrateDate desc limit 1) Qty
		from Raw_Material_tbl A
		inner join Product_Info_tbl B on A.Material_ItemCode = B.Product_Item_Code
		where A.Production_LotNo = #{LotNo};
	</select>

	<insert id="rawMaterialSaveDao">
		insert into Raw_Material_tbl (
			Production_LotNo, Material_LotNo, Material_ItemCode, Qty
		)values(
			#{Production_LotNo},
			#{Material_LotNo}, #{Material_ItemCode}, #{Qty}
		)
	</insert>
</mapper>